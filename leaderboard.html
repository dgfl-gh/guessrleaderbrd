<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EMN TimeGuessr Leaderboard</title>
  <link rel="icon" href="data:,">
  <style>
  :root { --bg:#0b0c10; --card:#111218; --muted:#9aa3b2; --fg:#e6e9ef; --acc:#6ea8fe; --border:#1b1e27; }
  * { box-sizing: border-box; }
  html,body { margin:0; height:100%; background:var(--bg); color:var(--fg); font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial,"Apple Color Emoji","Segoe UI Emoji"; }
  .container { max-width:960px; margin:0 auto; padding:24px 16px 48px; }
  header { display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:space-between; }
  h1 { font-size:20px; margin:0; letter-spacing:.2px; }
  .badge { display:inline-block; padding:2px 8px; border-radius:999px; background:#18202e; color:#bcd2ff; font-size:12px; border:1px solid #24304a; }
  nav { margin-top:12px; display:flex; gap:8px; }
  .tab { display:inline-flex; align-items:center; height:32px; padding:0 12px; border-radius:10px; border:1px solid var(--border); background:#10131b; color:#cbd4e1; text-decoration:none; font-weight:600; letter-spacing:.2px; }
  .tab:hover { border-color:#2a2f3a }
  .tab[aria-current="page"] { background:#18202e; color:#dbe7ff; border-color:#24304a; }
  .controls { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin:12px 0; }
  button, input[type="date"] { background:#1a1c23; color:var(--fg); border:1px solid var(--border); border-radius:10px; height:36px; padding:0 12px; font:inherit; cursor:pointer; }
  button:hover { border-color:#2a2f3a }
  button[disabled] { opacity:.5; cursor:not-allowed; }
  main .card { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:14px; box-shadow:0 10px 18px rgba(0,0,0,.25); }
  .status { color:var(--muted); font-size:12px; margin-bottom:6px; }
  table { width:100%; border-collapse:collapse; }
  th, td { padding:10px 8px; border-bottom:1px solid var(--border); text-align:left; }
  th { color:var(--muted); font-weight:600; font-size:12px; letter-spacing:.3px; text-transform:uppercase; }
  .rank { width:56px; text-align:right; color:var(--muted); }
  .score { font-variant-numeric: tabular-nums; text-align:right; }
  .username { font-weight:600; }
  .empty { padding:24px; text-align:center; color:var(--muted); }
  .err { color:#ffb4b4; }
  /* Map styles */
  .map-card { margin-top:12px; }
  .map-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; color:var(--muted); font-size:12px; }
  .map-container { position:relative; width:100%; aspect-ratio: 2 / 1; background:#0f1117; border:1px solid var(--border); border-radius:12px; overflow:hidden; }
  .map-container::before { content:""; position:absolute; inset:0; background-image: radial-gradient(transparent 0, transparent 98%, rgba(255,255,255,0.04) 100%), linear-gradient(0deg, rgba(255,255,255,.04) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,.04) 1px, transparent 1px); background-size: 100% 100%, 20px 20px, 20px 20px; background-position: center; }
  .pin { position:absolute; transform: translate(-50%, -100%); cursor:pointer; }
  .pin-dot { width:10px; height:10px; background:#ff6b6b; border:2px solid #fff; border-radius:50%; box-shadow:0 1px 4px rgba(0,0,0,.5); }
  .pin-label { position:absolute; top:-18px; left:50%; transform:translateX(-50%); background:#18202e; border:1px solid #24304a; color:#bcd2ff; font-size:10px; padding:1px 4px; border-radius:6px; white-space:nowrap; pointer-events:none; }
  .map-popup { position:absolute; max-width:min(420px, 80%); background:var(--card); color:var(--fg); border:1px solid var(--border); border-radius:12px; box-shadow:0 14px 28px rgba(0,0,0,.5); overflow:hidden; z-index:5; }
  .map-popup img { display:block; width:100%; height:auto; background:#000; }
  .map-popup .pop-body { padding:10px; font-size:13px; }
  .map-popup .pop-title { font-weight:700; margin-bottom:6px; }
  .map-popup .pop-meta { color:var(--muted); font-size:12px; margin-bottom:6px; }
  .map-popup .pop-close { position:absolute; top:6px; right:8px; background:transparent; border:none; color:#cbd4e1; cursor:pointer; font-size:18px; line-height:1; }
  footer { margin-top:12px; color:var(--muted); font-size:12px; display:flex; justify-content:space-between; align-items:center; gap:8px; flex-wrap:wrap; }
  .kbd { font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace; background:#0f1117; border:1px solid #1d2130; border-bottom-color:#171b28; padding:1px 6px; border-radius:6px; font-size:12px; color:#c6cbd3; }
  </style>
</head>
<body>
  <div class="container">
    <div id="site-header"></div>

    <section class="controls">
      <button id="prev">◀ Prev</button>
      <input id="date" type="date" />
      <button id="next">Next ▶</button>
      <button id="reload">Reload</button>
    </section>

    <main>
      <section class="card">
        <div id="status" class="status">Loading…</div>
        <table aria-label="Friends leaderboard">
          <thead>
            <tr><th class="rank">#</th><th>User</th><th class="score">Score</th></tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
        <div id="empty" class="empty" hidden>No data.</div>
      </section>

      <!-- World map of daily photos (only for past days) -->
      <section id="map-card" class="card map-card" hidden>
        <div class="map-header"><span>Photo locations</span><span id="map-status"></span></div>
        <div id="map" class="map-container"></div>
      </section>
    </main>

    <footer>
      <div>Tip: use <span class="kbd">←</span>/<span class="kbd">→</span> to change day.</div>
    </footer>
  </div>

  <script type="module">
    import { mountHeader } from '/src/guessrleaderbrd/header.js';
    mountHeader('daily');
  </script>
  <script type="module" src="/src/guessrleaderbrd/app.js"></script>
</body>
</html>
